<mxfile host="app.diagrams.net" modified="2025-11-10T12:00:00.000Z" agent="GitHub Copilot" version="24.7.17" etag="draw.io-fsm">
  <diagram id="workflow-fsm" name="Error Recovery Workflow FSM">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="Error Detection &amp; Recovery State Machine" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="334.5" y="40" width="500" height="40" as="geometry" />
        </mxCell>
        
        <!-- IDLE State -->
        <mxCell id="idle" value="IDLE&#xa;(Monitoring)" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="80" y="200" width="120" height="120" as="geometry" />
        </mxCell>
        
        <!-- PRINTING State -->
        <mxCell id="printing" value="PRINTING&#xa;(Normal Operation)" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="320" y="200" width="120" height="120" as="geometry" />
        </mxCell>
        
        <!-- ERROR_DETECTED State -->
        <mxCell id="error-detected" value="ERROR_DETECTED&#xa;(Sensor Alert)" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#ffe6cc;strokeColor=#d79b00;strokeWidth=2;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="560" y="200" width="120" height="120" as="geometry" />
        </mxCell>
        
        <!-- PAUSED State -->
        <mxCell id="paused" value="PAUSED&#xa;(Analyzing)" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="800" y="200" width="120" height="120" as="geometry" />
        </mxCell>
        
        <!-- ANALYZING State -->
        <mxCell id="analyzing" value="ANALYZING&#xa;(Error Table Lookup)" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="940" y="400" width="140" height="140" as="geometry" />
        </mxCell>
        
        <!-- UPDATING State -->
        <mxCell id="updating" value="UPDATING&#xa;(G-code Update)" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="700" y="400" width="140" height="140" as="geometry" />
        </mxCell>
        
        <!-- RESUMING State -->
        <mxCell id="resuming" value="RESUMING&#xa;(Continue Print)" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="460" y="400" width="140" height="140" as="geometry" />
        </mxCell>
        
        <!-- Transitions -->
        <mxCell id="t1" value="Start Print" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#000000;endArrow=classic;endFill=1;fontSize=12" edge="1" parent="1" source="idle" target="printing">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="t2" value="Sensor Trigger&#xa;(sensor=1)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#d79b00;endArrow=classic;endFill=1;fontSize=12" edge="1" parent="1" source="printing" target="error-detected">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="t3" value="Send PAUSE" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#d6b656;endArrow=classic;endFill=1;fontSize=12" edge="1" parent="1" source="error-detected" target="paused">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="t4" value="Start Analysis" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#d6b656;endArrow=classic;endFill=1;fontSize=12" edge="1" parent="1" source="paused" target="analyzing">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="860" y="340" />
              <mxPoint x="1010" y="340" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="t5" value="Solution Found" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#b85450;endArrow=classic;endFill=1;fontSize=12" edge="1" parent="1" source="analyzing" target="updating">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="t6" value="UPDATE_GCODE&#xa;Sent" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#82b366;endArrow=classic;endFill=1;fontSize=12" edge="1" parent="1" source="updating" target="resuming">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="t7" value="Send RESUME" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#82b366;endArrow=classic;endFill=1;fontSize=12" edge="1" parent="1" source="resuming" target="printing">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="380" y="470" />
              <mxPoint x="380" y="340" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="t8" value="Stop Print" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;endArrow=classic;endFill=1;fontSize=12;dashed=1" edge="1" parent="1" source="printing" target="idle">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="380" y="140" />
              <mxPoint x="140" y="140" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="t9" value="Error (No Solution)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#b85450;endArrow=classic;endFill=1;fontSize=12;dashed=1" edge="1" parent="1" source="analyzing" target="idle">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1010" y="600" />
              <mxPoint x="140" y="600" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- Legend -->
        <mxCell id="legend-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="640" width="320" height="140" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="90" y="650" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend1" value="• Normal states (green): Idle, Printing, Resuming" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="90" y="680" width="300" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend2" value="• Error states (yellow/orange): Error Detected, Paused, Analyzing" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="90" y="700" width="300" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend3" value="• Recovery states (red): Updating G-code" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="90" y="720" width="300" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend4" value="• Solid arrows: Normal flow | Dashed: Error/Stop" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="90" y="740" width="300" height="20" as="geometry" />
        </mxCell>
        
        <!-- Step annotations -->
        <mxCell id="step1" value="Step 1: Pause" style="text;html=1;strokeColor=none;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="720" y="245" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="step2" value="Step 2-3:&#xa;Read Position&#xa;&amp; Lookup" style="text;html=1;strokeColor=none;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="1000" y="320" width="80" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step4" value="Step 4:&#xa;Update&#xa;Parameters" style="text;html=1;strokeColor=none;fillColor=#f8cecc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="850" y="455" width="80" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step5" value="Step 5:&#xa;Send&#xa;G-code" style="text;html=1;strokeColor=none;fillColor=#f8cecc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="610" y="455" width="70" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step6" value="Step 6:&#xa;Resume" style="text;html=1;strokeColor=none;fillColor=#d5e8d4;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="350" y="370" width="70" height="40" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
